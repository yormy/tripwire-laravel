import{_ as s,o as a,c as n,V as l}from"./chunks/framework.5f0cae6b.js";const A=JSON.parse('{"title":"Tripwire Regex","description":"","frontmatter":{},"headers":[],"relativePath":"v1/guide/references/wires/regex.md","filePath":"v1/guide/references/wires/regex.md"}'),e={name:"v1/guide/references/wires/regex.md"},p=l(`<h1 id="tripwire-regex" tabindex="-1">Tripwire Regex <a class="header-anchor" href="#tripwire-regex" aria-label="Permalink to &quot;Tripwire Regex&quot;">​</a></h1><p>I build a few regex helper functions to make the config actually readable instead of 40 lines of regex. Long complicated regex also make mistakes really hard to debug. Hence a few helper functions</p><p>They can be found in <code>Yormy\\TripwireLaravel\\Services\\Regex</code></p><h1 id="constants" tabindex="-1">Constants <a class="header-anchor" href="#constants" aria-label="Permalink to &quot;Constants&quot;">​</a></h1><h2 id="regex-filler" tabindex="-1">Regex::FILLER <a class="header-anchor" href="#regex-filler" aria-label="Permalink to &quot;Regex::FILLER&quot;">​</a></h2><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> FILLER </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[\\s|\\x00]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// Different fillers to find filler stuffing</span></span></code></pre></div><h2 id="regex-fillersemi" tabindex="-1">Regex::FILLERSEMI <a class="header-anchor" href="#regex-fillersemi" aria-label="Permalink to &quot;Regex::FILLERSEMI&quot;">​</a></h2><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight has-diff"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> FILLERSEMI </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[;|/]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// Alternative fillers used in a different context</span></span></code></pre></div><h2 id="regex-quote" tabindex="-1">Regex::QUOTE <a class="header-anchor" href="#regex-quote" aria-label="Permalink to &quot;Regex::QUOTE&quot;">​</a></h2><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> QUOTE </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[&quot;|</span><span style="color:#A6ACCD;">\\&#39;</span><span style="color:#C3E88D;">|&amp;quot;|&amp;apos;]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// Alternatives for quotes</span></span></code></pre></div><h2 id="regex-lt" tabindex="-1">Regex::LT <a class="header-anchor" href="#regex-lt" aria-label="Permalink to &quot;Regex::LT&quot;">​</a></h2><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> LT </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[&lt;|&amp;lt;|%3c|¼|%BC]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">// Alternatives used for &lt;</span></span></code></pre></div><h2 id="regex-gt" tabindex="-1">Regex::GT <a class="header-anchor" href="#regex-gt" aria-label="Permalink to &quot;Regex::GT&quot;">​</a></h2><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> GT </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[&gt;|%3e|¾|%BE]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// Alternatives used for &gt;</span></span></code></pre></div><h1 id="functions" tabindex="-1">Functions <a class="header-anchor" href="#functions" aria-label="Permalink to &quot;Functions&quot;">​</a></h1><h2 id="regex-or" tabindex="-1">Regex::or() <a class="header-anchor" href="#regex-or" aria-label="Permalink to &quot;Regex::or()&quot;">​</a></h2><p>This takes an array and returns a string where the items are concatinated with a | to include in a regex statement</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Regex</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">or</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aaa</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">bbb</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">])</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// results: &#39;aaa|bbb&#39;</span></span></code></pre></div><h2 id="regex-forbidden" tabindex="-1">Regex::forbidden() <a class="header-anchor" href="#regex-forbidden" aria-label="Permalink to &quot;Regex::forbidden()&quot;">​</a></h2><p>This takes an array of words and coverts it to a regex string that can be directly included in the tripwires list</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">forbidden </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Regex</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">forbidden</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">aaa</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">bbb</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// results: &#39;#(aaa|bbb)#iUu&#39;</span></span></code></pre></div><h2 id="regex-makewhitespacesafe" tabindex="-1">Regex::makeWhitespaceSafe() <a class="header-anchor" href="#regex-makewhitespacesafe" aria-label="Permalink to &quot;Regex::makeWhitespaceSafe()&quot;">​</a></h2><p>Takes a string with spaces and converts it to string with one or more spaces or fillers (like null byte). This will prevent space/null byte stuffing</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Regex</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">or</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello world</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// results: &#39;hello[\\s|\\x00]+world&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// to find with 1 or more spaces/fillers between hello and world</span></span></code></pre></div><h2 id="regex-injectfillers" tabindex="-1">Regex::injectFillers() <a class="header-anchor" href="#regex-injectfillers" aria-label="Permalink to &quot;Regex::injectFillers()&quot;">​</a></h2><p>This will take an array and covert it to an array whereby each element went through <code>Regex::makeWhitespaceSafe</code></p><h2 id="example-sqli" tabindex="-1">Example Sqli <a class="header-anchor" href="#example-sqli" aria-label="Permalink to &quot;Example Sqli&quot;">​</a></h2><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">q </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">REGEX</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">QUOTE</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">orStatements </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Regex</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">or</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">union select</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">union \\+ select</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;{$</span><span style="color:#A6ACCD;">q</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> or true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">orPostgressForbidden </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Regex</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">forbidden</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pg_client_encoding</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">get_current_ts_config</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">sqliConfig </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WireDetailsConfig</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">make</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">tripwires</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">regex</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">injectFillers</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">#[\\d\\W](</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">orStatements</span><span style="color:#C3E88D;">)[\\d\\W]#iUu</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">orPostgressForbidden</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">])</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">);</span></span></code></pre></div><h2 id="example-xss" tabindex="-1">Example Xss <a class="header-anchor" href="#example-xss" aria-label="Permalink to &quot;Example Xss&quot;">​</a></h2><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">lt </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Regex</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">LT</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">gt </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Regex</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">GT</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">f2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Regex</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">FILLERSEMI</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">q </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">REGEX</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">QUOTE</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">evilStart </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Regex</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">forbidden</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;$</span><span style="color:#A6ACCD;">lt</span><span style="color:#C3E88D;"> script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;{$</span><span style="color:#A6ACCD;">lt</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">{$</span><span style="color:#A6ACCD;">f2</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> script</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">evilTokens </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Regex</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">forbidden</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;{$</span><span style="color:#A6ACCD;">gt</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">{$</span><span style="color:#A6ACCD;">gt</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">{$</span><span style="color:#A6ACCD;">lt</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> marquee</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">onerror = </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">q</span><span style="color:#C3E88D;"> javascript:document</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;$</span><span style="color:#A6ACCD;">lt</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">f2</span><span style="color:#C3E88D;"> BR SIZE</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">style = </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">q</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">= </span><span style="color:#A6ACCD;">\\\\\\&quot;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">f2</span><span style="color:#C3E88D;"> &amp; </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">f2</span><span style="color:#C3E88D;"> {</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">]);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">xssConfig </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">WireDetailsConfig</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">make</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">tripwires</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">Regex</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">injectFillers</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">evilStart</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">evilTokens</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">])</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">);</span></span></code></pre></div>`,30),o=[p];function t(r,c,D,F,y,i){return a(),n("div",null,o)}const d=s(e,[["render",t]]);export{A as __pageData,d as default};
