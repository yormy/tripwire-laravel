import{_ as s,o as a,c as e,V as l}from"./chunks/framework.5f0cae6b.js";const y=JSON.parse('{"title":"Session","description":"","frontmatter":{},"headers":[],"relativePath":"v1/guide/references/wires/session.md","filePath":"v1/guide/references/wires/session.md"}'),n={name:"v1/guide/references/wires/session.md"},o=l(`<h1 id="session" tabindex="-1">Session <a class="header-anchor" href="#session" aria-label="Permalink to &quot;Session&quot;">​</a></h1><div class="tip custom-block"><p class="custom-block-title">Goal</p><p>Prevent certain session injections</p></div><h2 id="enabled" tabindex="-1">Enabled <a class="header-anchor" href="#enabled" aria-label="Permalink to &quot;Enabled&quot;">​</a></h2><p>Enable or disable this wire</p><h2 id="methods" tabindex="-1">Methods <a class="header-anchor" href="#methods" aria-label="Permalink to &quot;Methods&quot;">​</a></h2><p>The methods specifies which methods should be inspected</p><p>Options:</p><ul><li>&#39;post&#39;</li><li>&#39;put&#39;</li><li>&#39;patch&#39;</li><li>&#39;get&#39;</li><li>&#39;all&#39; or &#39;*&#39;</li></ul><p>The &#39;all&#39; or &#39;*&#39; is a alias to inspect all methods</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">methods</span><span style="color:#89DDFF;">([</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">post</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">put</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">])</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// only post and put method</span></span></code></pre></div><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">methods</span><span style="color:#89DDFF;">([</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">])</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// all methods</span></span></code></pre></div><h2 id="attack-score" tabindex="-1">Attack score <a class="header-anchor" href="#attack-score" aria-label="Permalink to &quot;Attack score&quot;">​</a></h2><p>This is this wire severity, the higher the number the more severe. All attackScores will be summarized and if it exceeds the PunishScore the block will be activated. Set this to a number that reflects the severity.</p><ul><li>A very high number will immediately block the user/ip</li><li>A low number will only block if there are many requests</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><strong>sqli</strong> and <strong>xss</strong> are very common attack vectors with high confidence detection. You should set those to a very high number</p></div><h2 id="tripwires" tabindex="-1">Tripwires <a class="header-anchor" href="#tripwires" aria-label="Permalink to &quot;Tripwires&quot;">​</a></h2><p>Specify the list triggers that indicate a session injection</p><h2 id="example" tabindex="-1">Example <a class="header-anchor" href="#example" aria-label="Permalink to &quot;Example&quot;">​</a></h2><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">WireDetailsConfig</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">make</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">enabled</span><span style="color:#89DDFF;">(true)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">methods</span><span style="color:#89DDFF;">([</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">])</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">attackScore</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">tripwires</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@[\\|:]O:\\d{1,}:&quot;[\\w_][\\w\\d_]{0,}&quot;:\\d{1,}:{@i</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@[\\|:]a:\\d{1,}:{@i</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">]);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//... optional overrides</span></span></code></pre></div><p><a href="./optionals.html">optional global overriders</a></p>`,20),t=[o];function p(r,i,c,h,d,D){return a(),e("div",null,t)}const u=s(n,[["render",p]]);export{y as __pageData,u as default};
